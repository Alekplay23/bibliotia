{% extends "../../base.html" %} 
{% load static %} 
{% block title %}{% endblock title%} 

{% block content %}

<section class="py-5">
  <div class="container px-4 px-lg-5 my-5">
    <div class="row gx-4 gx-lg-5 align-items-center">
      <div class="col-md-5">
        <img
          class="card-img-top mb-5 mb-md-0"
          height="530px"
          src="{{ product.image.url }}"
          alt="{{ book.title }}"
        />
      </div>
      <div class="col-md-6">
        <h1 class="display-5 fw-bolder">{{ product.title }}</h1>
        <div class="fs-5 mb-5">
          <span>${{ product.price }}</span>
        </div>
        <p class="lead">{{ product.description }}</p>
        <br />
        <div class="col">
          <div class="row p-3">
            <div class="col-6">
              <label for="select"></label>
              <select id="select">
                <option value="">1</option>
                <option value="">2</option>
                <option value="">3</option>
                <option value="">4</option>
              </select>
            </div>
            <div class="col-6 text-start">
              <button type="button" id="add-button" value="{{ product.id }}" class="btn btn-danger btn-sm">
                Agregar al carrito
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>

  $(document).on('click', '#add-button', function(e){
    e.preventDefault();
    $.ajax({
      type: 'POST',
      url: '{% url "cart:cart_add" %}',
      data: {
        productid: $('#add-button').val(),
        productqty: $('#select option:selected').text(),
        csrfmiddlewaretoken: "{{ csrf_token }}",
        action: 'post',
      },
      success: function (json) {
        document.getElementById('cart-qty').innerHTML = json.qty;
      },
      error: function (xhr, errmsg, err) {}
    });
  });

</script>

{% endblock content %}
